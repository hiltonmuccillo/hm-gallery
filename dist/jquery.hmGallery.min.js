/*!
 * HM Gallery - jQuery image gallery with thumbnails, fullscreen and autoplay
 * Author: Hilton Muccillo
 */
!function(t){var e={startIndex:0,loop:!0,enableFullscreen:!0,autoplay:!1,autoplayInterval:4e3,transition:"fade",animationDuration:400};function n(n,s){this.$container=n,this.settings=t.extend({},e,s),this.items=[],this.currentIndex=0,this.$inner=null,this.$main=null,this.$mainImg=null,this.$caption=null,this.$thumbsScroll=null,this.$thumbsTrack=null,this.$fullscreenBtn=null,this._handleFsChange=null,this.autoplayTimer=null,this.autoplayInterval=this.settings.autoplayInterval,this.isPlaying=!1,this.$autoplayBtn=null,this.$counter=null,this._initialized=!1,this.init()}n.prototype.init=function(){var e=this,n=this.$container.find("img");if(n.length){n.each((function(n,s){var l=t(s);e.items.push({src:l.attr("src"),alt:l.attr("alt")||"",caption:l.data("caption")||""})})),n.hide(),this.buildMarkup();var s=this.settings.startIndex;(s<0||s>=this.items.length)&&(s=0),this.goTo(s,{instant:!0}),!1!==this.settings.enableFullscreen&&(this._handleFsChange=this.onFullscreenChange.bind(this),document.addEventListener("fullscreenchange",this._handleFsChange),document.addEventListener("webkitfullscreenchange",this._handleFsChange),document.addEventListener("mozfullscreenchange",this._handleFsChange),document.addEventListener("MSFullscreenChange",this._handleFsChange)),this.settings.autoplay&&this.startAutoplay()}},n.prototype.buildMarkup=function(){var e=this;this.$inner=t('<div class="hm-gallery-inner"></div>'),this.$main=t('<div class="hm-gallery-main"></div>');var n=t('<button type="button" class="hm-gallery-nav-btn hm-gallery-prev" aria-label="Previous">‹</button>'),s=t('<button type="button" class="hm-gallery-nav-btn hm-gallery-next" aria-label="Next">›</button>');this.$mainImg=t('<img src="" alt="">'),this.$caption=t('<div class="hm-gallery-caption" aria-live="polite"></div>'),this.$autoplayBtn=t('<button type="button" class="hm-gallery-autoplay-btn" aria-label="Play/Pause slideshow"></button>'),this.$main.append(this.$autoplayBtn),!1!==this.settings.enableFullscreen&&(this.$fullscreenBtn=t('<button type="button" class="hm-gallery-fs-btn" aria-label="Fullscreen" aria-pressed="false"></button>'),this.$main.append(this.$fullscreenBtn)),this.$counter=t('<div class="hm-gallery-counter"></div>'),this.$main.append(this.$counter),this.$main.append(n,this.$mainImg,this.$caption,s);var l=t('<div class="hm-gallery-thumbs"></div>');this.$thumbsScroll=t('<div class="hm-gallery-thumbs-scroll"></div>'),this.$thumbsTrack=t('<div class="hm-gallery-thumbs-track"></div>');var i=t('<button type="button" class="hm-gallery-thumbs-nav hm-gallery-thumbs-prev" aria-label="Previous thumbnails">‹</button>'),a=t('<button type="button" class="hm-gallery-thumbs-nav hm-gallery-thumbs-next" aria-label="Next thumbnails">›</button>');this.items.forEach((function(n,s){var l=t('<button type="button" class="hm-gallery-thumb" data-index="'+s+'"></button>'),i=t("<img>").attr({src:n.src,alt:n.alt});l.append(i),e.$thumbsTrack.append(l)})),this.$thumbsScroll.append(this.$thumbsTrack),l.append(i,this.$thumbsScroll,a),this.$inner.append(this.$main,l),this.$container.addClass("hm-gallery--initialized").append(this.$inner),n.on("click",(function(){e.prev()})),s.on("click",(function(){e.next()})),this.$thumbsTrack.on("click",".hm-gallery-thumb",(function(){var n=parseInt(t(this).data("index"),10);e.goTo(n)})),i.on("click",(function(){e.scrollThumbs("prev")})),a.on("click",(function(){e.scrollThumbs("next")})),this.$fullscreenBtn&&this.$fullscreenBtn.on("click",(function(){e.toggleFullscreen()})),this.$autoplayBtn.on("click",(function(){e.toggleAutoplay()}))},n.prototype.scrollThumbs=function(t){if(this.$thumbsScroll){var e=this.$thumbsScroll[0],n="next"===t?200:-200;e.scrollBy?e.scrollBy({left:n,behavior:"smooth"}):e.scrollLeft+=n}},n.prototype._updateMainImage=function(e,n,s,l){l=l||{};var i=this.settings.transition||"none",a=this.settings.animationDuration||400;if(l.instant||!this._initialized||"none"===i)return this.$mainImg.stop(!0,!0).css({opacity:1}),this.$mainImg.attr({src:e.src,alt:e.alt}),void(this._initialized=!0);this.$mainImg.stop(!0,!0);var r=s>n?1:-1;if("fade"===i)this.$mainImg.css({opacity:0}),this.$mainImg.attr({src:e.src,alt:e.alt}),this.$mainImg.animate({opacity:1},a);else if("slide"===i){var o=this;this.$main.css("position","relative");var c=t('<img class="hm-gallery-slide-img hm-gallery-slide-old">').attr({src:this.$mainImg.attr("src"),alt:this.$mainImg.attr("alt")}),h=t('<img class="hm-gallery-slide-img hm-gallery-slide-new">').attr({src:e.src,alt:e.alt});c.css({left:"50%"}),h.css({left:1===r?"150%":"-50%"}),this.$mainImg.css("opacity",0),this.$main.append(c,h);var u=1===r?"-50%":"150%";c.animate({left:u},a),h.animate({left:"50%"},a,(function(){o.$mainImg.attr({src:e.src,alt:e.alt}),o.$mainImg.css("opacity",1),c.remove(),h.remove()}))}else this.$mainImg.attr({src:e.src,alt:e.alt})},n.prototype.goTo=function(t,e){e=e||{};var n=this.items.length;if(n){var s=this.currentIndex;if(t<0||t>=n){if(!this.settings.loop)return;t<0&&(t=n-1),t>=n&&(t=0)}this.currentIndex=t;var l=this.items[t];if(this.$counter){var i=t+1;this.$counter.text(i+" / "+n)}l.caption?this.$caption.text(l.caption).show():this.$caption.text("").hide(),this.$thumbsTrack.find(".hm-gallery-thumb").removeClass("is-active");var a=this.$thumbsTrack.find('.hm-gallery-thumb[data-index="'+t+'"]').addClass("is-active");if(this.$thumbsScroll&&a.length){var r=this.$thumbsScroll[0],o=r.getBoundingClientRect(),c=a[0].getBoundingClientRect();c.left<o.left?r.scrollLeft+=c.left-o.left:c.right>o.right&&(r.scrollLeft+=c.right-o.right)}this._updateMainImage(l,s,t,e),this.isPlaying&&!e.fromAutoplay&&(this.stopAutoplay(),this.startAutoplay())}},n.prototype.next=function(){this.goTo(this.currentIndex+1)},n.prototype.prev=function(){this.goTo(this.currentIndex-1)},n.prototype.startAutoplay=function(){var t=this;this.isPlaying||(this.isPlaying=!0,this.$autoplayBtn&&this.$autoplayBtn.addClass("is-playing"),this.autoplayTimer=setInterval((function(){t.goTo(t.currentIndex+1,{fromAutoplay:!0})}),this.autoplayInterval))},n.prototype.stopAutoplay=function(){this.isPlaying&&(this.isPlaying=!1,this.$autoplayBtn&&this.$autoplayBtn.removeClass("is-playing"),clearInterval(this.autoplayTimer),this.autoplayTimer=null)},n.prototype.toggleAutoplay=function(){this.isPlaying?this.stopAutoplay():this.startAutoplay()},n.prototype._getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null},n.prototype.isFullscreen=function(){var t=this._getFullscreenElement();return t?t===this.$container[0]:this.$container.hasClass("hm-gallery--fullscreen")},n.prototype.enterFullscreen=function(){var t=this.$container[0];if(t){var e=t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen;if(e){var n=this;try{var s=e.call(t);s&&"function"==typeof s.catch&&s.catch((function(t){console.warn("Fullscreen request failed, falling back to CSS-only fullscreen",t),n.setFullscreenClass(!0)}))}catch(t){console.warn("Fullscreen request threw error, falling back to CSS-only fullscreen",t),this.setFullscreenClass(!0)}}else this.setFullscreenClass(!0)}},n.prototype.exitFullscreen=function(){var t=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;if(t&&this._getFullscreenElement()){var e=this;try{var n=t.call(document);n&&"function"==typeof n.catch&&n.catch((function(t){console.warn("Exit fullscreen failed, falling back to CSS-only fullscreen",t),e.setFullscreenClass(!1)}))}catch(t){console.warn("Exit fullscreen threw error, falling back to CSS-only fullscreen",t),this.setFullscreenClass(!1)}}else this.setFullscreenClass(!1)},n.prototype.toggleFullscreen=function(){this.isFullscreen()?this.exitFullscreen():this.enterFullscreen()},n.prototype.setFullscreenClass=function(t){this.$container.toggleClass("hm-gallery--fullscreen",!!t),this.$fullscreenBtn&&(this.$fullscreenBtn.toggleClass("is-active",!!t),this.$fullscreenBtn.attr("aria-pressed",t?"true":"false"))},n.prototype.onFullscreenChange=function(){var t=this._getFullscreenElement()===this.$container[0];this.setFullscreenClass(t)},t.fn.hmGallery=function(e){return this.each((function(){var s=t(this),l=s.data("hmGallery");l||(l=new n(s,e),s.data("hmGallery",l))}))}}(jQuery);